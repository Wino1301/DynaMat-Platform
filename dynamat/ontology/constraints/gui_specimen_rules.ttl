@prefix gui: <https://dynamat.utep.edu/gui/constraints#> .
@prefix dyn: <https://dynamat.utep.edu/ontology#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dc: <http://purl.org/dc/elements/1.1/> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

#################################################################
# SPECIMEN FORM CONSTRAINTS (Unified Format)
#################################################################

#================================================================
# 1.0 Specimen ID Generation
#================================================================

gui:specimen_c001 a gui:Constraint ;
    rdfs:label "Generate Specimen ID from Material" ;
    rdfs:comment "Auto-generates specimen ID in format DYNML-{materialCode}-{sequence} when material is selected. The materialCode is extracted from the selected material individual." ;
    dc:created "2025-01-15"^^xsd:date ;
    gui:forClass dyn:Specimen ;
    gui:triggers dyn:hasMaterial ;
    gui:triggerLogic gui:ALL ;
    gui:whenValue gui:anyValue ;
    gui:generationTarget dyn:hasSpecimenID ;
    gui:generationTemplate "DYNML-{materialCode}-{sequence}" ;
    gui:generationInputs (dyn:hasMaterial) ;
    gui:priority 1 .

#================================================================
# 2.0 Batch ID Population
#================================================================

gui:specimen_c002 a gui:Constraint ;
    rdfs:label "Populate manufacturing details from batch" ;
    rdfs:comment "When a SpecimenBatchID is selected, automatically populate material, manufacturing method, and process-specific fields (AM: build orientation & layer thickness, Machining: tolerance, Casting: temperatures & cooling) as read-only fields." ;
    dc:created "2025-01-15"^^xsd:date ;
    gui:forClass dyn:Specimen ;
    gui:triggers dyn:hasSpecimenBatchID ;
    gui:triggerLogic gui:ALL ;
    gui:whenValue gui:anyValue ;
    gui:populateFields (
        (dyn:hasMaterial "Material")
        (dyn:hasManufacturingMethod "Manufacturing Method")
        (dyn:hasBuildOrientation "Build Orientation")
        (dyn:hasLayerThickness "Layer Thickness")
        (dyn:hasMachiningTolerance "Machining Tolerance")
        (dyn:hasMoltenMetalTemperature "Molten Metal Temperature")
        (dyn:hasMoldTemperature "Mold Temperature")
        (dyn:hasCastCoolingDuration "Cast Cooling Duration")
    ) ;
    gui:makeReadOnly true ;
    gui:priority 2 .

#================================================================
# 3.0 Composite Phase Description Population
#================================================================

gui:specimen_c003 a gui:Constraint ;
    rdfs:label "Populate composite details from phase description" ;
    rdfs:comment "When a CompositePhaseDescription is selected, automatically populate matrix material, reinforcement material, and volume fractions as read-only fields." ;
    dc:created "2025-01-15"^^xsd:date ;
    gui:forClass dyn:Specimen ;
    gui:triggers dyn:hasCompositePhaseDescription ;
    gui:triggerLogic gui:ALL ;
    gui:whenValue gui:anyValue ;
    gui:populateFields (
        (dyn:hasMatrixMaterial "Matrix Material")
        (dyn:hasReinforcementMaterial "Reinforcement Material")
        (dyn:hasMatrixVolumeFraction "Matrix Volume Fraction")
        (dyn:hasReinforcementVolumeFraction "Reinforcement Volume Fraction")
    ) ;
    gui:makeReadOnly true ;
    gui:priority 3 .

#================================================================
# 4.0 Composite Material Fields Visibility
#================================================================

gui:specimen_c004 a gui:Constraint ;
    rdfs:label "Show composite phase description for composite materials" ;
    rdfs:comment "Displays composite phase description selector and nested composite property fields when selected material is of type Composite. Uses class membership check." ;
    dc:created "2025-01-15"^^xsd:date ;
    gui:forClass dyn:Specimen ;
    gui:triggers dyn:hasMaterial ;
    gui:triggerLogic gui:ALL ;
    gui:whenValue dyn:Composite ;
    gui:showFields (dyn:hasCompositePhaseDescription
                    dyn:hasMatrixMaterial
                    dyn:hasReinforcementMaterial
                    dyn:hasMatrixVolumeFraction
                    dyn:hasReinforcementVolumeFraction) ;
    gui:priority 4 .

#================================================================
# 5.0 Geometry Dimensions Visibility
#================================================================

#----------------------------------------------------------------
# 5.1 Cylindrical Shape: Visibility + Cross Section Calculation
#----------------------------------------------------------------

gui:specimen_c005 a gui:Constraint ;
    rdfs:label "Cylindrical specimen: original dimensions and cross-section" ;
    rdfs:comment "For cylindrical specimens, show diameter and height, hide other dimensions, and calculate cross-section from diameter. Formula: A = pi * (d/2)^2" ;
    dc:created "2025-01-15"^^xsd:date ;
    gui:forClass dyn:Specimen ;
    gui:triggers (dyn:hasShape dyn:hasOriginalDiameter) ;
    gui:triggerLogic gui:ALL ;
    gui:whenValue (dyn:CylindricalShape gui:anyValue) ;
    gui:showFields (dyn:hasOriginalDiameter dyn:hasOriginalHeight) ;
    gui:hideFields (dyn:hasOriginalLength
                    dyn:hasOriginalWidth
                    dyn:hasOriginalThickness
                    dyn:hasOriginalGaugeLength) ;
    gui:calculationFunction "circular_area_from_diameter" ;
    gui:calculationTarget dyn:hasOriginalCrossSection ;
    gui:calculationInputs (dyn:hasOriginalDiameter) ;
    gui:priority 5 .

gui:specimen_c006 a gui:Constraint ;
    rdfs:label "Cylindrical specimen: post-test dimensions and cross-section" ;
    rdfs:comment "For cylindrical specimens, show final diameter and height, hide other dimensions, and calculate cross-section from diameter. Formula: A = π(d/2)²" ;
    dc:created "2025-01-15"^^xsd:date ;
    gui:forClass dyn:Specimen ;
    gui:triggers (dyn:hasShape dyn:hasFinalDiameter) ;
    gui:triggerLogic gui:ALL ;
    gui:whenValue (dyn:CylindricalShape gui:anyValue) ;
    gui:showFields (dyn:hasFinalDiameter dyn:hasFinalHeight) ;
    gui:hideFields (dyn:hasFinalLength
                    dyn:hasFinalWidth
                    dyn:hasFinalThickness
                    dyn:hasFinalGaugeLength) ;
    gui:calculationFunction "circular_area_from_diameter" ;
    gui:calculationTarget dyn:hasFinalCrossSection ;
    gui:calculationInputs (dyn:hasFinalDiameter) ;
    gui:priority 6 .

#----------------------------------------------------------------
# 5.2 Cubic Shape: Visibility + Cross Section Calculation
#----------------------------------------------------------------

gui:specimen_c007 a gui:Constraint ;
    rdfs:label "Cubic specimen: original dimensions and cross-section" ;
    rdfs:comment "For cubic specimens, show length (as cube side), hide other dimensions, and calculate cross-section from length. Formula: A = length²" ;
    dc:created "2025-01-15"^^xsd:date ;
    gui:forClass dyn:Specimen ;
    gui:triggers (dyn:hasShape dyn:hasOriginalLength) ;
    gui:triggerLogic gui:ALL ;
    gui:whenValue (dyn:CubicShape gui:anyValue) ;
    gui:showFields (dyn:hasOriginalLength) ;
    gui:hideFields (dyn:hasOriginalDiameter
                    dyn:hasOriginalWidth
                    dyn:hasOriginalThickness
                    dyn:hasOriginalHeight
                    dyn:hasOriginalGaugeLength) ;
    gui:calculationFunction "square_area" ;
    gui:calculationTarget dyn:hasOriginalCrossSection ;
    gui:calculationInputs (dyn:hasOriginalLength) ;
    gui:priority 7 .

gui:specimen_c008 a gui:Constraint ;
    rdfs:label "Cubic specimen: post-test dimensions and cross-section" ;
    rdfs:comment "For cubic specimens, show final length, hide other dimensions, and calculate cross-section from length. Formula: A = length²" ;
    dc:created "2025-01-15"^^xsd:date ;
    gui:forClass dyn:Specimen ;
    gui:triggers (dyn:hasShape dyn:hasFinalLength) ;
    gui:triggerLogic gui:ALL ;
    gui:whenValue (dyn:CubicShape gui:anyValue) ;
    gui:showFields (dyn:hasFinalLength) ;
    gui:hideFields (dyn:hasFinalDiameter
                    dyn:hasFinalWidth
                    dyn:hasFinalThickness
                    dyn:hasFinalHeight
                    dyn:hasFinalGaugeLength) ;
    gui:calculationFunction "square_area" ;
    gui:calculationTarget dyn:hasFinalCrossSection ;
    gui:calculationInputs (dyn:hasFinalLength) ;
    gui:priority 8 .

#----------------------------------------------------------------
# 5.3 Dogbone Shape: Visibility + Cross Section Calculation
#----------------------------------------------------------------

gui:specimen_c009 a gui:Constraint ;
    rdfs:label "Dogbone specimen: original dimensions and cross-section" ;
    rdfs:comment "For dogbone specimens, show length, gauge length, width, and thickness, hide other dimensions, and calculate cross-section from width × thickness. Formula: A = width × thickness" ;
    dc:created "2025-01-15"^^xsd:date ;
    gui:forClass dyn:Specimen ;
    gui:triggers (dyn:hasShape dyn:hasOriginalWidth dyn:hasOriginalThickness) ;
    gui:triggerLogic gui:ALL ;
    gui:whenValue (dyn:DogboneShape gui:anyValue gui:anyValue) ;
    gui:showFields (dyn:hasOriginalLength
                    dyn:hasOriginalGaugeLength
                    dyn:hasOriginalWidth
                    dyn:hasOriginalThickness) ;
    gui:hideFields (dyn:hasOriginalDiameter dyn:hasOriginalHeight) ;
    gui:calculationFunction "rectangular_area" ;
    gui:calculationTarget dyn:hasOriginalCrossSection ;
    gui:calculationInputs (dyn:hasOriginalWidth dyn:hasOriginalThickness) ;
    gui:priority 9 .

gui:specimen_c010 a gui:Constraint ;
    rdfs:label "Dogbone specimen: post-test dimensions and cross-section" ;
    rdfs:comment "For dogbone specimens, show final length, gauge length, width, and thickness, hide other dimensions, and calculate cross-section from width × thickness. Formula: A = width × thickness" ;
    dc:created "2025-01-15"^^xsd:date ;
    gui:forClass dyn:Specimen ;
    gui:triggers (dyn:hasShape dyn:hasFinalWidth dyn:hasFinalThickness) ;
    gui:triggerLogic gui:ALL ;
    gui:whenValue (dyn:DogboneShape gui:anyValue gui:anyValue) ;
    gui:showFields (dyn:hasFinalLength
                    dyn:hasFinalGaugeLength
                    dyn:hasFinalWidth
                    dyn:hasFinalThickness) ;
    gui:hideFields (dyn:hasFinalDiameter dyn:hasFinalHeight) ;
    gui:calculationFunction "rectangular_area" ;
    gui:calculationTarget dyn:hasFinalCrossSection ;
    gui:calculationInputs (dyn:hasFinalWidth dyn:hasFinalThickness) ;
    gui:priority 10 .

#----------------------------------------------------------------
# 5.4 Hide All When (Select...) / Default
#----------------------------------------------------------------

gui:specimen_c011 a gui:Constraint ;
    rdfs:label "Hide all dimensions when no shape and no role selected" ;
    rdfs:comment "Complete constraint (prevents inverse). Triggers on both shape and specimen role changes. Hides all dimension fields when BOTH shape is '(Select...)' AND specimen role is None. When either is selected, doesn't apply inverse - other constraints control visibility." ;
    dc:created "2025-01-19"^^xsd:date ;
    gui:forClass dyn:Specimen ;
    gui:triggers dyn:hasShape  ;
    gui:triggerLogic gui:ALL ;
    gui:whenValue "(Select...)" ;
    gui:hideFields (dyn:hasOriginalLength
                    dyn:hasOriginalDiameter
                    dyn:hasOriginalWidth
                    dyn:hasOriginalThickness
                    dyn:hasOriginalHeight
                    dyn:hasOriginalGaugeLength
                    dyn:hasOriginalCrossSection
                    dyn:hasFinalLength
                    dyn:hasFinalDiameter
                    dyn:hasFinalWidth
                    dyn:hasFinalThickness
                    dyn:hasFinalHeight
                    dyn:hasFinalGaugeLength
                    dyn:hasFinalCrossSection
                    dyn:hasOriginalMass
                    dyn:hasFinalMass) ;
    gui:priority 11 .

#================================================================
# 6.0 Manufacturing History Parameters
#================================================================

#----------------------------------------------------------------
# 6.1 Manufactured Created Date
#----------------------------------------------------------------

gui:specimen_c012 a gui:Constraint ;
    rdfs:label "Show manufactured date when manufacturing method selected" ;
    rdfs:comment "Displays manufactured date field when any manufacturing method is selected. Hidden by default to prevent auto-filling today's date when not needed." ;
    dc:created "2025-01-19"^^xsd:date ;
    gui:forClass dyn:Specimen ;
    gui:triggers dyn:hasManufacturingMethod ;
    gui:triggerLogic gui:ALL ;
    gui:whenValue gui:anyValue ;
    gui:showFields (dyn:hasManufacturedDate) ;
    gui:priority 12 .

#----------------------------------------------------------------
# 6.2 Additive Manufacturing Parameters Visibility
#----------------------------------------------------------------

gui:specimen_c013 a gui:Constraint ;
    rdfs:label "Show AM parameters for 3D printed specimens" ;
    rdfs:comment "Displays build orientation and layer thickness fields when manufacturing method includes 3D Printing/AM (supports multiple manufacturing methods)." ;
    dc:created "2025-01-15"^^xsd:date ;
    gui:forClass dyn:Specimen ;
    gui:triggers dyn:hasManufacturingMethod ;
    gui:triggerLogic gui:ANY ;
    gui:whenValue dyn:3DPrinting ;
    gui:showFields (dyn:hasBuildOrientation
                    dyn:hasLayerThickness) ;
    gui:priority 13 .

gui:specimen_c014 a gui:Constraint ;
    rdfs:label "Show build angle field for custom orientations" ;
    rdfs:comment "Displays build angle field when build orientation is set to Custom Orientation, allowing user to specify non-standard angles." ;
    dc:created "2025-01-15"^^xsd:date ;
    gui:forClass dyn:Specimen ;
    gui:triggers dyn:hasBuildOrientation ;
    gui:triggerLogic gui:ALL ;
    gui:whenValue dyn:CustomOrientation ;
    gui:showFields (dyn:hasBuildAngle) ;
    gui:priority 14 .

#----------------------------------------------------------------
# 6.3 Machining Parameters Visibility
#----------------------------------------------------------------

gui:specimen_c015 a gui:Constraint ;
    rdfs:label "Show machining tolerance for machined specimens" ;
    rdfs:comment "Displays machining tolerance field when manufacturing method includes Machining (supports multiple manufacturing methods)." ;
    dc:created "2025-01-15"^^xsd:date ;
    gui:forClass dyn:Specimen ;
    gui:triggers dyn:hasManufacturingMethod ;
    gui:triggerLogic gui:ANY ;
    gui:whenValue dyn:Machining ;
    gui:showFields (dyn:hasMachiningTolerance) ;
    gui:priority 15 .

#----------------------------------------------------------------
# 6.4 Casting Parameters Visibility
#----------------------------------------------------------------

gui:specimen_c016 a gui:Constraint ;
    rdfs:label "Show casting parameters for cast specimens" ;
    rdfs:comment "Displays casting-specific fields (metal temperature, mold temperature, cooling duration) when manufacturing method includes Casting (supports multiple manufacturing methods)." ;
    dc:created "2025-01-15"^^xsd:date ;
    gui:forClass dyn:Specimen ;
    gui:triggers dyn:hasManufacturingMethod ;
    gui:triggerLogic gui:ANY ;
    gui:whenValue dyn:Casting ;
    gui:showFields (dyn:hasMoltenMetalTemperature
                    dyn:hasMoldTemperature
                    dyn:hasCastCoolingDuration) ;
    gui:priority 16 .

#----------------------------------------------------------------
# 6.5 Heat Treatment Parameters Visibility
#----------------------------------------------------------------

gui:specimen_c017 a gui:Constraint ;
    rdfs:label "Show heat treatment parameters for heat-treated specimens" ;
    rdfs:comment "Displays heat treatment detail fields (temperature, duration, cooling time, cooling rate) when heat treatment requires processing details." ;
    dc:created "2025-01-15"^^xsd:date ;
    gui:forClass dyn:Specimen ;
    gui:triggers dyn:hasHeatTreatment ;
    gui:triggerLogic gui:ANY ;
    gui:whenValue dyn:AnnealedHT,
                  dyn:FurnaceCooledHT,
                  dyn:AirCoolHT,
                  dyn:WaterQuenchHT,
                  dyn:OilQuenchHT ;
    gui:showFields (dyn:hasHeatTreatmentTemperature
                    dyn:hasHeatTreatmentDuration
                    dyn:hasCoolingTime
                    dyn:hasCoolingRate) ;
    gui:priority 17 .

#----------------------------------------------------------------
# 6.6 Surface Finish Parameters Visibility
#----------------------------------------------------------------

gui:specimen_c018 a gui:Constraint ;
    rdfs:label "Show polishing parameters for polished surfaces" ;
    rdfs:comment "Displays final grit size and polishing compound fields when surface finish is Polished. Hides surface roughness." ;
    dc:created "2025-01-15"^^xsd:date ;
    gui:forClass dyn:Specimen ;
    gui:triggers dyn:hasSurfaceFinish ;
    gui:triggerLogic gui:ALL ;
    gui:whenValue dyn:PolishedFinish ;
    gui:showFields (dyn:hasFinalGritSize
                    dyn:hasPolishingCompound) ;
    gui:hideFields (dyn:hasSurfaceRoughness) ;
    gui:priority 18 .

gui:specimen_c019 a gui:Constraint ;
    rdfs:label "Show lapping parameters for lapped surfaces" ;
    rdfs:comment "Displays final grit size, polishing compound, and surface roughness fields when surface finish is Lapped." ;
    dc:created "2025-01-15"^^xsd:date ;
    gui:forClass dyn:Specimen ;
    gui:triggers dyn:hasSurfaceFinish ;
    gui:triggerLogic gui:ALL ;
    gui:whenValue dyn:LappedFinish ;
    gui:showFields (dyn:hasFinalGritSize
                    dyn:hasPolishingCompound
                    dyn:hasSurfaceRoughness) ;
    gui:priority 19 .

#================================================================
# 7.0 Lattice Structure Parameters Visibility
#================================================================

gui:specimen_c020 a gui:Constraint ;
    rdfs:label "Show structure parameters for lattice structures" ;
    rdfs:comment "Displays structure parameter fields only when structure type is Lattice. Hides these fields for all other structure types (Monolithic, Foam, Graded, etc.)." ;
    dc:created "2025-01-15"^^xsd:date ;
    gui:forClass dyn:Specimen ;
    gui:triggers dyn:hasStructure ;
    gui:triggerLogic gui:ALL ;
    gui:whenValue dyn:LatticeStructure ;
    gui:showFields (dyn:hasLatticeType
                    dyn:hasLatticeCellsX
                    dyn:hasLatticeCellsY
                    dyn:hasLatticeCellsZ
                    dyn:hasVoxelSize
                    dyn:hasLatticeNodeRadius
                    dyn:hasLatticeStrutMinX
                    dyn:hasLatticeStrutMaxX
                    dyn:hasLatticeStrutMinY
                    dyn:hasLatticeStrutMaxY
                    dyn:hasLatticeStrutMinZ
                    dyn:hasLatticeStrutMaxZ
                    dyn:hasLatticeNx
                    dyn:hasLatticeNy
                    dyn:hasLatticeNz
                    dyn:hasLatticeRingThickness) ;
    gui:priority 20 .

